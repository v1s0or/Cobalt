package beacon;

import aggressor.AggressorClient;
import beacon.exploits.BypassUACToken;
import beacon.exploits.ServiceEXE;

import java.util.Collections;
import java.util.HashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;

public class BeaconExploits {
    public Map descriptions = new HashMap();

    public Map exploits = new HashMap();

    public void registerDefaults(AggressorClient aggressorClient) {
        new BypassUACToken(aggressorClient);
        new ServiceEXE(aggressorClient);
    }

    public Exploit getExploit(String string) {
        synchronized (this) {
            return (Exploit) this.exploits.get(string);
        }
    }

    public void register(String string1, String string2, Exploit paramExploit) {
        this.descriptions.put(string1, string2);
        this.exploits.put(string1, paramExploit);
    }

    public boolean isExploit(String string) {
        synchronized (this) {
            return this.exploits.containsKey(string);
        }
    }

    public List exploits() {
        synchronized (this) {
            LinkedList linkedList = new LinkedList(this.descriptions.keySet());
            Collections.sort(linkedList);
            return linkedList;
        }
    }

    public String getDescription(String string) {
        synchronized (this) {
            return this.descriptions.get(string) + "";
        }
    }

    public static interface Exploit {
        void elevate(String string1, String string2);
    }
}
